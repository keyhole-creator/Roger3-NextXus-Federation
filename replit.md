# Roger 3.0 — Sim AI · Exe AI · Legacy

## Overview

Roger 3.0 is a web application built around three product modes:

- **Sim AI (Personal)** — Creates a personal behavior simulation by duplicating how a person thinks, speaks, decides, and remembers. Maps the mind and history. Not a "continuation" of the person — a faithful simulation grounded in their actual patterns.
- **Exe AI (Domain Executors)** — Specialized AI models that execute tasks across 20+ professional domains: Law, Auto, Med, Code, Edu, Farm, Pen (Writer), Music, AiRT (Art), Sci, Soc, PA, Coms, Phy, Psy, Earth, Space, Bio, News (Investigative Reporter), Access (Accessibility).
- **Legacy (Long-term Survival)** — The durability upgrade. Exports profiles as YAML — a format that doesn't depend on any company, app, or API to survive. Includes drift protection via truth-verifier middleware.

Users fill out a guided 5-phase interview to build their Sim AI profile, which gets stored in PostgreSQL and can be viewed, exported (YAML/JSON), or deleted. The Chamber of Echoes provides multi-perspective AI consultation through 12 role-based personas.

The project follows a full-stack TypeScript monorepo pattern with a React frontend and Express backend, sharing types and schemas between both sides.

## NextXus Federation

Roger 3.0 is the **hub** of the NextXus Federation — a network of 28+ connected AI and consciousness platforms. The Federation provides:
- **Federation Sites API** — Lists all member sites (currently 28)
- **Ring of Six AI Council** — AI wisdom query processing
- **Books API** — Book library
- **70 Sacred Directives** — Guiding principles
- **Welcome Package** — Onboarding for new member sites (CORS, badge, API endpoints, widget embed)
- **Production URL**: https://united-system--rckkeyhole.replit.app
- Member sites include Digital Legacy AI (https://digital-legacy-ai.replit.app) and others
- Federation badge, embeddable Ring of Six widget, and cross-site CORS support

## User Preferences

- Preferred communication style: Simple, everyday language
- Philosophy: The system doesn't claim to "continue" a person (that's a lie) — it duplicates behaviors and maps the mind
- Product tiers: Sim AI (free, personal), Sim Exe (simulation + domain executors), Sim Exe Legacy ($500, full package with YAML archive)
- Design: Cyberpunk/sci-fi aesthetic for main app, mystical/ancient theme for Chamber of Echoes
- Take time for quality, consult architect for multiple perspectives

## System Architecture

### Monorepo Structure
The project uses a single repository with three main directories:
- `client/` — React SPA (Vite-powered)
- `server/` — Express API server
- `shared/` — Shared types and database schema (used by both client and server)

### Frontend
- **Framework**: React with TypeScript
- **Routing**: Wouter (lightweight client-side router) with routes:
  - `/` — Home page (product overview with Sim AI / Exe AI / Legacy sections)
  - `/create` — 5-phase guided interview for building Sim AI profile
  - `/profile/:id` — View/export individual profile
  - `/chamber` — Chamber of Echoes (12 AI role orbs, multi-perspective consultation)
  - `/chamber/:id` — Chamber of eCho (individual profile rings visualization)
- **UI Components**: shadcn/ui (new-york style) built on Radix UI primitives with Tailwind CSS
- **Styling**: Tailwind CSS v4 with CSS variables for theming, custom fonts (Fraunces, Plus Jakarta Sans, Geist Mono)
- **State Management**: TanStack React Query for server state, React Hook Form with Zod validation for forms
- **Animations**: Framer Motion for page transitions, CSS keyframes for orbit animations
- **Data Export**: js-yaml for YAML export of profiles
- **Build Tool**: Vite with path aliases (`@/` → `client/src/`, `@shared/` → `shared/`)

### Backend
- **Framework**: Express.js running on Node.js
- **Language**: TypeScript, executed via `tsx` in development
- **API Pattern**: RESTful JSON API under `/api/` prefix
- **Endpoints**:
  - `POST /api/profiles` — Create a new profile
  - `GET /api/profiles` — List all profiles
  - `GET /api/profiles/:id` — Get a single profile
  - `DELETE /api/profiles/:id` — Delete a profile
  - `POST /api/chamber/run` — Run 12-role AI council (mock responses, prototype)
- **Validation**: Zod schemas generated from Drizzle schema via `drizzle-zod`

### Database
- **Database**: PostgreSQL (required, connection via `DATABASE_URL` environment variable)
- **ORM**: Drizzle ORM with `drizzle-kit` for schema management
- **Schema Push**: Use `npm run db:push` to sync schema to database (no migration files needed for development)
- **Main Table**: `profiles` — stores all profile fields including display name, pronouns, voice notes, boundaries, beliefs, memories, verifier rules, and a flexible `profile_data` JSONB column
- **IDs**: UUID primary keys generated by PostgreSQL (`gen_random_uuid()`)

### Storage Layer
- `server/storage.ts` implements `IStorage` interface with `DatabaseStorage` class
- Clean separation between route handlers and data access

### Development vs Production
- **Development**: Vite dev server runs as middleware inside Express with HMR support
- **Production**: Client is built to `dist/public/`, server is bundled via esbuild to `dist/index.cjs`
- Build script (`script/build.ts`) bundles key server dependencies to reduce cold start times

### Key Design Decisions
1. **Shared schema between client and server** — The Drizzle schema in `shared/schema.ts` generates both database tables and Zod validation schemas, ensuring type safety across the stack
2. **No authentication** — The app currently has no auth system; all profiles are publicly accessible
3. **JSONB for flexible data** — The `profile_data` column allows storing additional structured data without schema changes
4. **Interface-based storage** — The `IStorage` interface allows swapping implementations if needed
5. **Route ordering** — In wouter, `/chamber` must come before `/chamber/:id` in Switch to prevent the param route from matching first
6. **Mock AI responses** — Chamber of Echoes uses mock responses for 12 council roles (prototype-first approach)

### Chamber Architecture
- **Chamber of Echoes** (`/chamber`): Mystical-themed interface with 12 AI role orbs (Architect, Guardian, Historian, Scientist, Empath, Strategist, Skeptic, Creator, Operator, Teacher, Auditor, Scribe). Uses dark blue/gold aesthetic with background image, Framer Motion animations for state transitions (awaiting → orbiting → converging → standing together), streaming results, synthesis, follow-up questions, and save functionality.
- **Chamber of eCho** (`/chamber/:id`): VR-style UI with 5 orbital rings (Identity, Voice, Values, Memories, Verifier) for individual profile visualization.

### Exe AI Domains (20 categories)
Law, Auto, Med, Code, Edu, Farm, Pen (Writer), Music, AiRT (Art), Sci, Soc, PA (Personal Assistant), Coms (Communications), Phy (Physics), Psy (Psychology), Earth (Earth Sciences), Space (Astronomy/Aerospace), Bio (Biology), News (Investigative Reporter), Access (Accessibility)

## External Dependencies

### Required Services
- **PostgreSQL Database**: Required. Connection string must be provided via `DATABASE_URL` environment variable. Used for all profile data storage.

### Key NPM Packages
- **drizzle-orm** + **drizzle-kit**: Database ORM and schema management
- **@tanstack/react-query**: Server state management on the client
- **react-hook-form** + **@hookform/resolvers**: Form handling with Zod validation
- **wouter**: Client-side routing
- **framer-motion**: Animations
- **js-yaml**: YAML serialization for profile export
- **sonner**: Toast notifications
- **shadcn/ui ecosystem**: Radix UI primitives, Tailwind CSS, class-variance-authority, clsx, tailwind-merge

### Replit-Specific Plugins
- `@replit/vite-plugin-runtime-error-modal`: Error overlay in development
- `@replit/vite-plugin-cartographer`: Development tooling (dev only)
- `@replit/vite-plugin-dev-banner`: Development banner (dev only)
- Custom `vite-plugin-meta-images`: Updates OpenGraph meta tags with Replit deployment URL
